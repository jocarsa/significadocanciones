console.log(localStorage.getItem("usuario"));var servidor="../servidor/";function reemplazaTildes(e){return e.replace("\xc3\xa1","a").replace("\xc3\xa9","e").replace("\xc3\xad","i").replace("\xc3\xb3","o").replace("\xc3\xba","u")}function cargaCancion(e,n,t){let o=document.importNode(n.content,!0);o.querySelector("h3").innerHTML=e.titulo,o.querySelector("h4").innerHTML=e.artista,o.querySelector("p").innerHTML=e.significado,o.querySelector("h5").innerHTML="por: "+e.usuario,o.querySelector("article").onclick=function(){document.querySelectorAll("article").forEach(function(e){e.style.display="none"}),this.style.display="block",this.classList.add("alturacompleta")},t.appendChild(o)}window.onload=function(){console.log("web cargada");var e,n=document.querySelector("#cancion"),t=document.querySelector("#canciones"),n=document.querySelector("#cancion"),t=document.querySelector("#canciones");fetch(servidor+"?o=tabla&tabla=canciones").then(function(e){return e.json()}).then(function(o){e=o,console.log(o),e.forEach(function(e){cargaCancion(e,n,t)})});document.querySelector("#buscador").onkeyup=function(){document.querySelector("#canciones").innerHTML="";let o=this.value;e.forEach(function(e){(reemplazaTildes(e.titulo).toLowerCase().includes(reemplazaTildes(o).toLowerCase())||reemplazaTildes(e.artista).toLowerCase().includes(reemplazaTildes(o).toLowerCase())||reemplazaTildes(e.significado).toLowerCase().includes(reemplazaTildes(o).toLowerCase()))&&cargaCancion(e,n,t)})},document.getElementById("nueva").onclick=function(){document.getElementById("modal").style.display="block",document.getElementById("modal").classList.add("aparece"),console.log("ok"),void 0==localStorage.getItem("usuario")?(document.getElementById("formularionuevacancion").style.display="none",document.getElementById("formulariologin").style.display="block"):(document.getElementById("formularionuevacancion").style.display="block",document.getElementById("formulariologin").style.display="none")},document.getElementById("enviar").onclick=function(){let n=document.getElementById("titulo").value,t;fetch(servidor+"?o=insertar&tabla=canciones",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({titulo:n,artista:document.getElementById("artista").value,significado:document.getElementById("significado").value,usuarios_usuario:localStorage.getItem("usuario")})}).then(function(e){return e.json()}).then(function(n){console.log(n),fetch(servidor+"?o=tabla&tabla=canciones").then(function(e){return e.json()}).then(function(n){console.log(n),e=n}),setTimeout(function(){document.getElementById("modal").style.display="none"},1e3),document.getElementById("modal").classList.add("desaparece")})},document.getElementById("login").onclick=function(){let e=document.getElementById("usuario").value,n;fetch(servidor+"?o=buscar&tabla=usuarios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usuario:e,contrasena:document.getElementById("contrasena").value})}).then(function(e){return e.json()}).then(function(e){console.log(e),console.log(e.length),e.length>0?(localStorage.setItem("usuario",e[0].Identificador),document.getElementById("formularionuevacancion").style.display="block",document.getElementById("formulariologin").style.display="none"):document.getElementById("retroalimentacion").innerHTML="Intento de acceso incorrecto"})}};